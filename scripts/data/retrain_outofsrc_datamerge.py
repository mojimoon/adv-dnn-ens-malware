import os
import pandas as pd

pwd = os.path.dirname(os.path.abspath(__file__))
_scripts = os.path.dirname(pwd)
root = os.path.dirname(_scripts)
_results = os.path.join(root, 'results')

src1 = os.path.join(_results, 'retrain_selected_outofsrc_andro.csv')
src2 = os.path.join(_results, 'retrain_selected_outofsrc_andro_2.csv')

# overwrite src1 with src2
df1 = pd.read_csv(src1)
df2 = pd.read_csv(src2)

cols = ['selection_metric', 'budget', 'id_ratio', 'epochs']

df = pd.concat([df1, df2], axis=0, ignore_index=True)
df = df.drop_duplicates(subset=cols, keep='last')

df.to_csv(src1, index=False)
