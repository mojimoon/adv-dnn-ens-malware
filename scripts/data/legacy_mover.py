'''
selection_metric,ood,epochs,id_ratio,budget,original_acc,retrain_acc,acc_improvement
->
model,retrain_type,test_set,selection_metric,ood,epochs,id_ratio,budget,original_acc,retrain_acc,acc_improvement
'''

import os
import sys

pwd = os.path.dirname(os.path.abspath(__file__))
root = os.path.dirname(os.path.dirname(pwd))
file_dir = os.path.join(root, 'results', 'retrain')

print(file_dir)

model = 'deepdrebin'
for retrain_type in ['type1', 'type2']:
    for test_set in ['hybrid', 'original']:
        file_path = os.path.join(file_dir, 'retrain_outofsrc_{}_{}_{}.csv'.format(model, retrain_type, test_set))
        if not os.path.exists(file_path):
            continue
        print('Processing:', file_path)
        with open(file_path, 'r') as f:
            lines = f.readlines()
        with open(file_path + '.new', 'w') as f:
            f.write('model,retrain_type,test_set,selection_metric,ood,epochs,id_ratio,budget,original_acc,retrain_acc,acc_improvement\n')
            for line in lines[1:]:
                if line.count(',') == 7:
                    line = ','.join([model, retrain_type, test_set, line])
                f.write(line)
        print('Done:', file_path)